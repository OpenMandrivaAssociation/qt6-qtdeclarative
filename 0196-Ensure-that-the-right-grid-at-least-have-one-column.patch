From d3143bd5a97837581b1490a034f837be1485d75e Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jan=20Arve=20S=C3=A6ther?= <jan-arve.saether@qt.io>
Date: Tue, 14 Oct 2025 17:47:32 +0200
Subject: [PATCH 196/239] Ensure that the right grid at least have one column
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

If the initial window width was so large that the inital layout was
determined to be the "largeLayout" (wider than 450 pixels), then the
binding

    columns: Math.min(Math.round(width / 130), 6)

initially resulted in 0 columns because the width was initially
evaluated to be 0, which caused the grids implicitWidth to be 0 (because
it couldn't fit any items when columns was 0). Hence, it was
"deadlocked": it didn't add items because columns was 0, and it
didn't increase columns because it's width was 0.

An item in a layout with implicitWidth == 0 will always have lower
priority to grow than items with a larger implicitWidth - hence the grid
was stuck at width == 0

Pick-to: 6.8
Fixes: QTBUG-140533
Change-Id: I558463ac33db36fa7eb8df4c70adc94f90c69e8f
Reviewed-by: Santhosh Kumar <santhosh.kumar.selvaraj@qt.io>
Reviewed-by: Tor Arne Vestb√∏ <tor.arne.vestbo@qt.io>
(cherry picked from commit cecd690d60dcdadca21e06f0a9edc80acc8fe9ea)
Reviewed-by: Qt Cherry-pick Bot <cherrypick_bot@qt-project.org>
---
 examples/quick/responsivelayouts/responsivelayouts.qml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/examples/quick/responsivelayouts/responsivelayouts.qml b/examples/quick/responsivelayouts/responsivelayouts.qml
index c7e0c22e38..904b57fa1d 100644
--- a/examples/quick/responsivelayouts/responsivelayouts.qml
+++ b/examples/quick/responsivelayouts/responsivelayouts.qml
@@ -28,7 +28,7 @@ Window {
                 fill: parent
                 margins: 8
             }
-            columns: Math.min(Math.round(width / 130), 6)
+            columns: Math.max(1, Math.min(Math.round(width / 130), 6))
             Repeater {
                 model: 60
                 delegate: Rectangle {
-- 
2.51.2

